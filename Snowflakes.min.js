(function(g,h){"object"===typeof exports&&"undefined"!==typeof module?module.exports=h():"function"===typeof define&&define.amd?define(h):(g=g||self,g.Snowflakes=h())})(this,function(){function g(c,a){if(!(c instanceof a))throw new TypeError("Cannot call a class as a function");}function h(c,a){for(var b=0;b<a.length;b++){var d=a[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(c,d.key,d)}}function q(c,a,b){a&&h(c.prototype,a);b&&h(c,b);return c}
function k(c,a){Object.keys(a).forEach(function(b){var d=b;n&&-1<b.search("animation")&&(d=n+b[0].toUpperCase()+b.substr(1));c.style[d]=a[b]})}function l(c){c&&c.parentNode&&c.parentNode.removeChild(c)}function p(c,a,b,d,e){return d+(e-d)*(c-a)/(b-a)}var n="";"undefined"!==typeof window&&(n=-1<Array.prototype.slice.call(window.getComputedStyle(document.documentElement,"")).join(",").search(/,animation/)?"":"Webkit");var m=function(){function c(a){g(this,c);var b=a.minSize===a.maxSize;this.innerSize=
b?0:0+Math.floor(Math.random()*(c.maxInnerSize-0));this.size=c.calcSize(this.innerSize,a);var d=document.createElement("div"),e=document.createElement("div"),f=this.getAnimationProps(a);f={animationName:"snowflake_gid_".concat(a.gid,"_y"),animationDelay:f.animationDelay,animationDuration:f.animationDuration,left:99*Math.random()+"%",top:-Math.sqrt(2)*this.size+"px",width:this.size+"px",height:this.size+"px"};b||(f.opacity=p(this.size,a.minSize,a.maxSize,a.minOpacity,a.maxOpacity));k(d,f);k(e,{animationName:"snowflake_gid_".concat(a.gid,
"_x_").concat(this.innerSize),animationDelay:4*Math.random()+"s"});d.classList.add("snowflake");e.classList.add("snowflake__inner");a.types&&e.classList.add("snowflake__inner_type_"+(0+Math.floor(Math.random()*(a.types-0))));a.wind&&e.classList.add("snowflake__inner_wind");a.rotation&&e.classList.add("snowflake__inner_rotation"+(.5<Math.random()?"":"_reverse"));d.appendChild(e);this._elem=d}q(c,[{key:"getAnimationProps",value:function(a){var b=a.containerHeight/50/a.speed;return{animationDelay:Math.random()*
b+"s",animationDuration:p(this.size,a.minSize,a.maxSize,b,b/3)+"s"}}},{key:"resize",value:function(a){a=this.getAnimationProps(a);k(this._elem,a)}},{key:"appendTo",value:function(a){a.appendChild(this._elem)}},{key:"destroy",value:function(){delete this._elem}}],[{key:"calcSize",value:function(a,b){return Math.floor(p(a,0,c.maxInnerSize,b.minSize,b.maxSize))}}]);return c}();(function(c,a,b){a in c?Object.defineProperty(c,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):c[a]=b;return c})(m,"maxInnerSize",
20);var r="",t=function(){function c(a){r='.snowflakes_gid_value .snowflake__inner_type_0:before,snowflakes_gid_value .snowflake__inner_type_1:before,snowflakes_gid_value .snowflake__inner_type_2:before,snowflakes_gid_value .snowflake__inner_type_3:before,snowflakes_gid_value .snowflake__inner_type_4:before,snowflakes_gid_value .snowflake__inner_type_5:before{background-image:url("'+a.url+'")}';g(this,c);this.params=this._setParams(a);this._isBody=this.params.container===document.body;this._setGid();
this._container=this._appendContainer();this.params.stop&&this.stop();this._appendStyles();this._appendFlakes();this._handleResize=this._handleResize.bind(this);window.addEventListener("resize",this._handleResize,!1)}q(c,[{key:"destroy",value:function(){this._removeStyles();l(this._container);delete this._container;this._flakes.forEach(function(a){return a.destroy()});delete this._flakes;delete this.params;window.removeEventListener("resize",this._handleResize,!1)}},{key:"start",value:function(){this._container.classList.remove("snowflakes_paused")}},
{key:"stop",value:function(){this._container.classList.add("snowflakes_paused")}},{key:"_setGid",value:function(){c._gid=c._gid||0;c._gid++;this._gid=c._gid}},{key:"_handleResize",value:function(){var a=this._getFlakeParams();k(this._container,{display:"none"});this._flakes.forEach(function(b){return b.resize(a)});this._updateAnimationStyle();k(this._container,{display:"block"})}},{key:"_appendContainer",value:function(){var a=document.createElement("div");a.classList.add("snowflakes");var b="snowflakes_gid_".concat(this._gid);
a.classList.add(b);this._isBody&&a.classList.add("snowflakes_body");k(a,{zIndex:this.params.zIndex});this.params.container.appendChild(a);return a}},{key:"_appendStyles",value:function(){c._count=c._count||0;c._count||(this._mainStyleNode=this._injectStyle('.snowflake{position:absolute;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;-webkit-animation:snowflake_unknown 10s linear infinite;animation:snowflake_unknown 10s linear infinite;will-change:transform}.snowflake__inner,.snowflake__inner:before{position:absolute;top:0;right:0;bottom:0;left:0}.snowflake__inner:before{content:"";background-size:100% 100%}.snowflake__inner_wind{-webkit-animation:snowflake_unknown 2s ease-in-out infinite alternate;animation:snowflake_unknown 2s ease-in-out infinite alternate}.snowflake__inner_rotation:before{-webkit-animation:snowflake_rotation 10s linear infinite;animation:snowflake_rotation 10s linear infinite}.snowflake__inner_rotation_reverse:before{-webkit-animation:snowflake_rotation_reverse 10s linear infinite;animation:snowflake_rotation_reverse 10s linear infinite}.snowflakes{pointer-events:none}.snowflakes_paused .snowflake,.snowflakes_paused .snowflake__inner,.snowflakes_paused .snowflake__inner:before{-webkit-animation-play-state:paused;animation-play-state:paused}.snowflakes_body{position:fixed;top:0;left:0;width:100%;height:1px}@-webkit-keyframes snowflake_rotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes snowflake_rotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes snowflake_rotation_reverse{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(-1turn);transform:rotate(-1turn)}}@keyframes snowflake_rotation_reverse{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(-1turn);transform:rotate(-1turn)}}'));
c._count++;this._imagesStyleNode=this._injectStyle(r.replace(/\{color\}/g,encodeURIComponent(this.params.color)));this._animationStyleNode=this._injectStyle(this._getAnimationStyle())}},{key:"_injectStyle",value:function(a,b){var d=a.replace(/_gid_value/g,"_gid_".concat(this._gid)),e=b;e||(e=document.createElement("style"),document.body.appendChild(e));e.styleSheet?e.styleSheet.cssText=d:"textContent"in e?e.textContent=d:e.innerHTML=d;return e}},{key:"_getFlakeParams",value:function(){var a=this._height(),
b=this.params;return{containerHeight:a,gid:this._gid,count:b.count,speed:b.speed,rotation:b.rotation,minOpacity:b.minOpacity,maxOpacity:b.maxOpacity,minSize:b.minSize,maxSize:b.maxSize,types:b.types,wind:b.wind}}},{key:"_appendFlakes",value:function(){var a=this,b=this._getFlakeParams();this._flakes=[];for(var d=0;d<this.params.count;d++)this._flakes.push(new m(b));this._flakes.sort(function(e,f){return e.size-f.size}).forEach(function(e){e.appendTo(a._container)})}},{key:"_setParams",value:function(a){a=
a||{};var b={};[["color","#5ECDEF"],["container",document.body],["count",50],["speed",1],["stop",!1],["rotation",!0],["minOpacity",.6],["maxOpacity",1],["minSize",10],["maxSize",25],["types",6],["width"],["height"],["wind",!0],["zIndex",9999]].forEach(function(d){var e=d[0];d=d[1];b[e]="boolean"===typeof d?e in a?a[e]:d:a[e]||d});return b}},{key:"_getAnimationStyle",value:function(){var a=this._height()+this.params.maxSize*Math.sqrt(2)+"px",b=this._gid;a="@-webkit-keyframes snowflake_gid_".concat(b,
"_y{from{-webkit-transform:translateY(").concat("0px",")}to{-webkit-transform:translateY(").concat(a,");}}\n@keyframes snowflake_gid_").concat(b,"_y{from{transform:translateY(").concat("0px",")}to{transform:translateY(").concat(a,")}}");for(var d=0;d<=m.maxInnerSize;d++){var e=m.calcSize(d,this.params)+"px";a+="@-webkit-keyframes snowflake_gid_".concat(b,"_x_").concat(d,"{from{-webkit-transform:translateX(0px)}to{-webkit-transform:translateX(").concat(e,");}}\n@keyframes snowflake_gid_").concat(b,
"_x_").concat(d,"{from{transform:translateX(0px)}to{transform:translateX(").concat(e,")}}")}return a}},{key:"_updateAnimationStyle",value:function(){this._injectStyle(this._getAnimationStyle(),this._animationStyleNode)}},{key:"_removeStyles",value:function(){c._count--;1>!c._count&&(l(this._mainStyleNode),delete this._mainStyleNode);l(this._imagesStyleNode);delete this._imagesStyleNode;l(this._animationStyleNode);delete this._animationStyleNode}},{key:"_height",value:function(){var a;if(!(a=this.params.height)){if(this._isBody){a=
document.body;var b=document.documentElement;if(window.innerHeight)var d=window.innerHeight;else b&&b.clientHeight?d=b.clientHeight:a&&(d=a.clientHeight)}else d=this.params.container.offsetHeight+this.params.maxSize;a=d}return a}}]);return c}();return function(c){return new t(c)}});